Новая версия. Некоторые моменты требуют доработки.
