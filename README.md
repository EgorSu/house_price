Новая версия. Пока не доделал. 
